# 任务进展

## 当前状态

- 文档状态：`PRD / 任务池 / 任务进展` 已对齐当前实现。
- 任务池状态：本轮无未完成开发项（仅保留滚动评审）。
- 质量状态：持续要求 `lint`、单测、e2e、`cargo check` 通过后再交付。

## 已实现能力（汇总）

1. 工程与基础能力
- 完成 `Tauri + React + TypeScript` 初始化。
- 统一中文界面与中文文档。
- `Makefile` 统一常用命令（初始化、启动、测试、seed、版本等）。
- 接入 GitHub Actions 自动发版（`v*` tag 触发构建 + Release + 安装包/Updater 元数据上传）。
- 增加签名与发版操作文档，提供 `pbcopy` 一键复制 secrets 内容与 Makefile 快捷命令。
- `docs/` 文件名已统一为英文命名，便于跨平台与自动化脚本引用。
- 本轮改动已按主题分批提交，避免未提交改动长期堆积。
- README 已按 0.2.x 当前实现重写，覆盖开发、测试、发版与排障路径。
- README 已二次重构为用户视角；开发/贡献内容已迁移到 `docs/development.md`。
- GitHub Actions 发布链路已优化：加入 Rust 缓存、默认先构建 mac 平台、减少重复前端构建开销。
- 发版脚本已修复：版本 bump 后自动提交版本文件，再打 tag 推送，避免残留未提交改动。

2. 翻译主链路
- 接入 Ollama `translategemma`。
- 调用时按官方 prompt format 组装请求（仅请求时拼接，不持久化）。
- 首次启动向导支持 Ollama 可达性与模型检查。
- 输入支持粘贴与键入分流：`Cmd+V` 自动探测 HTML 并转 Markdown，键入需手动触发翻译。

3. 结果展示与阅读体验
- 结果支持 Markdown（带行号编辑器）/HTML 预览切换。
- 双栏等宽、块级对齐与联动阅读。
- 解决双栏滚动互相干扰，改为按段落块进行定位联动。
- 修复“查看时滚动导致顶部工具栏消失”：顶部工具栏改为全页面常驻，并增加滚动边界隔离（overscroll containment）。
- 修复顶栏常驻后的布局副作用：恢复顶部与文本框之间控制区显示，历史详情页改为稳定三行网格布局。
- 布局升级为“顶部固定 + 中部自适应 + 底部折叠 Dock”，并支持 Dock 拖拽调高。
- 页面级不滚动，仅编辑区/预览区允许纵向滚动。
- 顶部左侧增加英文名言轮播（句子/作者/出处，60 秒切换）。
- 底部状态/日志图标在折叠态点击时会自动展开并切换到对应面板。

4. 历史记录与导出
- 历史记录表格分页、多页码跳转、标题可编辑、记录可删除。
- 支持历史回看与继续编辑重译（更新当前记录，不重复新建）。
- 新增“新建翻译”入口：可从历史详情一键退出覆盖模式并清空开始全新翻译。
- 支持多选导出 EPUB（向导参数、章节排序）。
- 修复 iBooks 兼容问题，导出成功支持 toast 提示。

5. 翻译引擎与偏好
- 引擎管理表格化：新增、编辑、启停、软删除、默认引擎切换。
- 无引擎时引导配置，无默认引擎时要求显式选择。
- 记录保留引擎快照信息，软删除后历史可回显“已删除”状态。
- 用户偏好支持默认导出目录、默认 EPUB 作者。

6. 菜单、更新与日志
- 原生菜单支持“关于 / 检查更新”。
- 检查更新对接 GitHub `releases/latest`。
- 翻译链路日志增强：开始/结束/耗时/失败细节，便于定位卡顿。
- 修复自动发版阻塞问题：更新 tauri-action 参数并替换默认 bundle identifier。

## 当前待办

1. 暂无阻塞型新任务
- 以任务池新增项为准，进入“先拆分后执行再回填”的循环。

## 长期滚动方向

1. 继续优化阅读体验
- 提升双栏块对齐与滚动联动稳定性。
- 细化不同内容结构（长段落、软换行、列表）的对齐策略。

2. 继续强化可维护性
- 维持小步提交与文档同步。
- 对高频回归点补齐 e2e 覆盖，降低布局与交互回归概率。
