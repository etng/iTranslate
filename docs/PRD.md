# iTranslate 产品需求文档（PRD）

## 1. 目标

构建一个本地优先的翻译桌面工具，默认基于 Ollama `translategemma`，强调格式保真、历史可追溯、后续可扩展多模型。

## 2. 目标用户

- 需要本地离线/私有翻译的开发者、内容编辑者。
- 需要处理 Markdown/HTML 技术文档翻译的用户。

## 3. 范围

### 3.1 本期范围

- Tauri + React 桌面应用。
- 首次启动向导：Ollama 可达性与模型存在性验证。
- 翻译主流程：源语言/目标语言选择、输入、翻译、结果展示。
- HTML 输入自动转 Markdown 再翻译。
- 结果双视图：Markdown + 渲染 HTML。
- 历史记录与分页、详情只读回看、标题可编辑。
- 菜单：关于、检查更新。
- 单元测试与 e2e。

### 3.2 非本期范围

- 账号体系、云同步。
- 多语言 UI。
- 自动静默更新（本期保留确认下载安装）。

## 4. 关键业务规则

- 默认语言：源语言英语，目标语言简体中文。
- translategemma 请求必须包含官方 prompt format 前缀。
- 当输入疑似 HTML 时，先转 Markdown，再发起翻译。
- 翻译结果必须落历史。
- 打开历史详情不触发模型调用，不新增历史。
- 历史详情下语言选择器禁用，只展示记录值。

## 5. 版本规则

- 版本号支持 `主.次.补丁.构建号`。
- 更新比较优先比较前三段，前三段相同再比较构建号。

## 6. 可扩展设计

- `TranslatorModelConfig` 作为统一模型配置。
- `TranslateProvider` 预留 `ollama/custom`。
- 翻译请求通过统一 `translateWithModel` 入口。

## 7. 验收标准

- 能在本机 Ollama + translategemma 环境完成翻译。
- HTML 输入可被转换并输出结构稳定结果。
- 历史分页可跳转多页，回退保留页码。
- 菜单项可触发关于与检查更新。
- `lint/test/e2e/cargo check` 全部通过。
